---
title: ElevenLabs Setup
description: complete guide to configuring the ElevenLabs voice agent for natural-sounding conversation analysis
---

CultureLens uses [ElevenLabs](https://elevenlabs.io) for two things: a real-time conversational AI agent that conducts voice sessions with users, and a text-to-speech API that generates audio debriefs after analysis.

this guide covers configuring the ElevenLabs agent to sound natural and conversational rather than robotic and scripted.

## architecture

the voice pipeline works as follows:

```
user speaks → browser microphone → WebSocket → ElevenLabs agent
                                                    ↓
                                         agent processes speech
                                                    ↓
                                         agent responds via TTS
                                                    ↓
user hears response ← browser audio ← WebSocket ← audio stream
```

there are two ElevenLabs integration points in the codebase:

| integration          | file                                     | description                                                      |
| -------------------- | ---------------------------------------- | ---------------------------------------------------------------- |
| conversational agent | `components/voice-agent.tsx`             | real-time WebSocket voice sessions via `@11labs/react` SDK       |
| text-to-speech       | `app/api/elevenlabs/tts/route.ts`        | generates audio debriefs from analysis text, stores in Firestore |
| signed URL           | `app/api/elevenlabs/signed-url/route.ts` | creates authenticated WebSocket URLs for the voice agent         |

## environment variables

```bash
# required in .env
ELEVENLABS_API_KEY=your_api_key_here
ELEVENLABS_AGENT_ID=agent_5401kfq4a552e61962kx44qcbcrn
```

get your API key from [elevenlabs.io/app/settings](https://elevenlabs.io/app/settings). the agent ID is created in the ElevenLabs Conversational AI dashboard.

## configuring the agent

### step 1: access the dashboard

1. go to [elevenlabs.io/app/conversational-ai](https://elevenlabs.io/app/conversational-ai)
2. find your agent (ID: `agent_5401kfq4a552e61962kx44qcbcrn`)
3. click **Edit Agent**

### step 2: update the system prompt

1. in the agent editor, find the **System Prompt** section
2. delete the current prompt
3. paste the full prompt from `AGENT_PROMPT.md` in the project root
4. this prompt instructs the agent to be neutral, non-judgmental, and culturally aware

### step 3: configure voice settings

| setting            | recommended value | effect                                                                |
| ------------------ | ----------------- | --------------------------------------------------------------------- |
| stability          | 0.5–0.6           | lower = more natural variation; higher = more consistent but monotone |
| similarity boost   | 0.7–0.8           | how closely output matches the base voice                             |
| style exaggeration | 0.4–0.5           | conversational delivery without being dramatic                        |
| speaker boost      | enabled           | improves clarity and presence                                         |

### step 4: configure conversation settings

| setting                    | recommended value | effect                                      |
| -------------------------- | ----------------- | ------------------------------------------- |
| mode                       | conversational    | casual tone rather than formal/professional |
| response length            | medium            | 60–90 second responses                      |
| enable interruptions       | yes               | allows natural back-and-forth               |
| turn detection sensitivity | medium            | balanced between too eager and too slow     |

### step 5: test

1. save the agent
2. open the CultureLens app locally
3. click "Connect to Agent" in the voice section
4. have a test conversation and listen for natural filler words, neutral observations, and conversational tone

## before vs. after

**before (default settings):**

> "I have identified several communication patterns in your conversation. Person A interrupted Person B five times during the discussion."

**after (tuned settings):**

> "Mm, so listening to that... I noticed something about the pacing. When you brought up the weekend plans, the response came really quick — like, almost before you finished your sentence. Did that feel different to you?"

## what natural sounds like

- occasional filler words ("um", "like", "you know")
- varied sentence structure and pacing
- contractions ("I'm", "you're", "that's")
- neutral observations without judgment or disclaimers
- cultural awareness without stereotyping
- invites reflection rather than asserting truth

## troubleshooting

| problem                  | solution                                                                  |
| ------------------------ | ------------------------------------------------------------------------- |
| agent sounds robotic     | verify the full system prompt was pasted, lower stability to 0.4–0.5      |
| agent gives disclaimers  | old prompt may be cached — disconnect and reconnect                       |
| no filler words          | lower stability further, enable "Natural Speech" if available             |
| connection fails         | check `ELEVENLABS_API_KEY` and `ELEVENLABS_AGENT_ID` in `.env`            |
| WebSocket errors         | verify signed URL endpoint is returning valid URLs, check browser console |
| rate limit errors on TTS | TTS is limited to 10 requests per 60 seconds per user                     |

## related

- [voice quickstart](/docs/guides/voice-quickstart) — minimal steps to get natural voice output
- [voice selection](/docs/guides/voice-selection) — in-app voice switching
- [voice settings cheatsheet](/docs/guides/voice-settings) — copy-paste settings reference
